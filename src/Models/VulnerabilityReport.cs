
// Copyright (c) Cingulara LLC 2019 and Tutela LLC 2019. All rights reserved.
// Licensed under the GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007 license. See LICENSE file in the project root for full license information.

using System;
using System.Collections.Generic;
using MongoDB.Bson.Serialization.Attributes;
using MongoDB.Bson;

namespace openrmf_msg_report.Models
{
    [Serializable]
    public class VulnerabilityReport
    {
        public VulnerabilityReport () {
            cciList = new List<string>(); // don't make it null
            isWebDatabase = false;
            webDatabaseSite = "";
            webDatabaseInstance = "";
        }

        [BsonId]
        // standard BSonId generated by MongoDb
        public ObjectId InternalId { get; set; }
        public string InternalIdString { get { return InternalId.ToString();}}

        public string artifactId {get; set;}
        public string systemGroupId {get; set;}
        public string vulnid { get; set; }
        public string hostname { get; set; }
        public string checklistType { get; set; }
        public string checklistRelease { get; set; }
        public string checklistVersion { get; set; }
        public string ruleTitle { get; set; }
        public string severity { get; set; }
        public int severityCategory { get {
            if (string.IsNullOrEmpty(severity))
                return 0;
            else if (severity.ToLower() == "high")
                return 3;
            else if (severity.ToLower() == "medium")
                return 2;
            else if (severity.ToLower() == "low")
                return 1;
            else
                return 4;
        } }
        public string status { get; set; }
        public List<string> cciList { get; set; }
        public string details { get; set; }
        public string comments { get; set; }
        public string discussion { get; set; }
        public string fixText { get; set; }
        public string checkContent { get; set; }
        public string severityOverride { get; set; }
        public string severityJustification { get; set; }
        public string securityControlNumbers { get; set; }
        public string cciReferences { get; set; }

        [BsonDateTimeOptions]
        public DateTime created { get; set; }

        [BsonDateTimeOptions]
        public DateTime? updatedOn { get; set; }

        public Guid createdBy { get; set; }
        public Guid? updatedBy { get; set; }

        // v1.12
        public bool isWebDatabase { get; set; }
        public string webDatabaseSite { get; set; }
        public string webDatabaseInstance { get; set; }
    }
}